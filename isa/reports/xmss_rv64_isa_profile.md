# XMSS RISC-V ISA Profile

Generated: 2026-02-18 16:49:15 UTC
Toolchain: `GNU objdump (GNU Binutils for Ubuntu) 2.42`
Input: `impl/c/build-rv/libxmss.a`
Lookup source: `third_party/riscv-opcodes/` (generated by `gen_lookup.sh`)

## Methodology

This report analyses **`libxmss.a`** — the static library containing only
XMSS algorithm code (params, hash, WOTS, XMSS, XMSS-MT, BDS, utils).
Unlike test binaries, this excludes `printf`, `malloc`, stack guards,
and other libc/test-harness code that would pollute the ISA profile.

Mnemonic-to-extension classification uses an authoritative lookup table
generated from the `riscv-opcodes` submodule (the same database used by
the RISC-V toolchain). This avoids the hand-written classifier bugs of
the previous analysis (e.g. `zext.h` misclassified as I instead of Zbb).

C (compressed) encoding is detected from instruction byte width in the raw
objdump output: 2 bytes = 16-bit compressed, 4 bytes = 32-bit standard.
GNU objdump renders compressed instructions using uncompressed aliases
(`sd` not `c.sd`, `li` not `c.li`), so mnemonic-based C detection
would always report C=0.

## Per-object-file summary

| Object file | Total insns | Unique mnemonics | C-encoded | C % |
|-------------|-------------|------------------|-----------|-----|
| `address.c.o` | 99 | 8 | 38 | 38% |
| `bds.c.o` | 1130 | 38 | 626 | 55% |
| `bds_serialize.c.o` | 473 | 31 | 255 | 53% |
| `ltree.c.o` | 129 | 24 | 90 | 69% |
| `params.c.o` | 286 | 33 | 172 | 60% |
| `sha2_local.c.o` | 1953 | 34 | 656 | 33% |
| `shake_local.c.o` | 1337 | 38 | 594 | 44% |
| `treehash.c.o` | 484 | 29 | 243 | 50% |
| `utils.c.o` | 47 | 14 | 32 | 68% |
| `wots.c.o` | 760 | 34 | 361 | 47% |
| `xmss.c.o` | 637 | 28 | 383 | 60% |
| `xmss_hash.c.o` | 1082 | 30 | 552 | 51% |
| `xmss_mt.c.o` | 1145 | 39 | 672 | 58% |

**Total: 9562 instructions (49 unique mnemonics) across 13 object files**


## Semantic extension summary

Instruction counts grouped by ISA extension (semantic, not encoding).
The "extension" is what the instruction DOES, regardless of whether it
was emitted in compressed (16-bit) or standard (32-bit) encoding.

| Extension | Refs | Unique mnemonics | Notes |
|-----------|------|------------------|-------|
| **I** | 9505 | 46 | Base integer (always required) |
| **M** | 57 | 3 | Integer multiply/divide |

## Per-extension mnemonic detail

### I

| Count | Mnemonic | Object files |
|------:|----------|-------------|
| 1086 | `mv` | bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, utils.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 1050 | `ld` | bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 902 | `sd` | bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 538 | `addi` | bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, utils.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 525 | `auipc` | bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 490 | `li` | bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, utils.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 449 | `lw` | address.c.o, bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 435 | `add` | bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, utils.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 431 | `jalr` | bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 391 | `slli` | bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, utils.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 379 | `srli` | address.c.o, bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, utils.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 342 | `sw` | address.c.o, bds.c.o, bds_serialize.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, wots.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 255 | `or` | params.c.o, sha2_local.c.o, shake_local.c.o, utils.c.o |
| 219 | `xor` | bds.c.o, ltree.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, utils.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 200 | `sb` | address.c.o, bds.c.o, bds_serialize.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, utils.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 181 | `lbu` | address.c.o, bds.c.o, bds_serialize.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, utils.c.o, wots.c.o, xmss_hash.c.o |
| 161 | `addiw` | bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, utils.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 141 | `srliw` | address.c.o, bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, wots.c.o, xmss.c.o, xmss_mt.c.o |
| 135 | `addw` | bds.c.o, bds_serialize.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 131 | `slliw` | bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 129 | `lui` | bds.c.o, bds_serialize.c.o, params.c.o, treehash.c.o, wots.c.o, xmss.c.o, xmss_mt.c.o |
| 107 | `j` | bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 86 | `lwu` | bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, shake_local.c.o, treehash.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 83 | `ret` | address.c.o, bds.c.o, bds_serialize.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, utils.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 73 | `bne` | bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, utils.c.o, wots.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 69 | `bnez` | bds.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 62 | `beqz` | bds.c.o, bds_serialize.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, utils.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 62 | `and` | sha2_local.c.o, shake_local.c.o, wots.c.o, xmss_mt.c.o |
| 56 | `bltu` | bds.c.o, bds_serialize.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 48 | `sext.w` | bds.c.o, bds_serialize.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 46 | `subw` | bds.c.o, bds_serialize.c.o, sha2_local.c.o, shake_local.c.o, wots.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 44 | `bgeu` | bds.c.o, ltree.c.o, params.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, wots.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 44 | `beq` | bds.c.o, bds_serialize.c.o, params.c.o, shake_local.c.o, treehash.c.o, wots.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 28 | `not` | sha2_local.c.o, shake_local.c.o, xmss_mt.c.o |
| 25 | `sub` | bds.c.o, sha2_local.c.o, shake_local.c.o, treehash.c.o, xmss.c.o, xmss_hash.c.o, xmss_mt.c.o |
| 18 | `srlw` | bds.c.o, treehash.c.o, wots.c.o, xmss_mt.c.o |
| 18 | `andi` | bds.c.o, ltree.c.o, sha2_local.c.o, treehash.c.o, wots.c.o, xmss.c.o, xmss_mt.c.o |
| 16 | `zext.b` | bds.c.o, sha2_local.c.o |
| 10 | `sllw` | bds.c.o, bds_serialize.c.o |
| 9 | `srl` | shake_local.c.o, xmss_mt.c.o |
| 9 | `sll` | params.c.o, shake_local.c.o, wots.c.o, xmss_mt.c.o |
| 9 | `jr` | bds.c.o, ltree.c.o, params.c.o, shake_local.c.o |
| 8 | `lhu` | address.c.o |
| 2 | `sh` | bds.c.o |
| 2 | `negw` | shake_local.c.o, wots.c.o |
| 1 | `ori` | shake_local.c.o |

### M

| Count | Mnemonic | Object files |
|------:|----------|-------------|
| 37 | `mulw` | bds_serialize.c.o, ltree.c.o, params.c.o, treehash.c.o, wots.c.o, xmss.c.o, xmss_mt.c.o |
| 17 | `mul` | bds.c.o, bds_serialize.c.o, xmss_mt.c.o |
| 3 | `divuw` | params.c.o |


## Compressed (C) encoding statistics

The C extension provides 16-bit encodings for common instructions. The
assembler emits these automatically when targeting `rv64gc`. This is an
encoding optimisation (smaller code size) — it does not change semantics.

| Metric | Value |
|--------|------:|
| Total instructions | 9562 |
| Standard (32-bit) | 4888 |
| Compressed (16-bit) | 4674 |
| C encoding ratio | 48% |

### Per-object C encoding

| Object file | Total | C-encoded | C % |
|-------------|------:|----------:|-----:|
| `address.c.o` | 99 | 38 | 38% |
| `bds.c.o` | 1130 | 626 | 55% |
| `bds_serialize.c.o` | 473 | 255 | 53% |
| `ltree.c.o` | 129 | 90 | 69% |
| `params.c.o` | 286 | 172 | 60% |
| `sha2_local.c.o` | 1953 | 656 | 33% |
| `shake_local.c.o` | 1337 | 594 | 44% |
| `treehash.c.o` | 484 | 243 | 50% |
| `utils.c.o` | 47 | 32 | 68% |
| `wots.c.o` | 760 | 361 | 47% |
| `xmss.c.o` | 637 | 383 | 60% |
| `xmss_hash.c.o` | 1082 | 552 | 51% |
| `xmss_mt.c.o` | 1145 | 672 | 58% |

## Per-object extension breakdown

Which extensions are used in each object file.

### `address.c.o`

| Extension | Refs | Mnemonics |
|-----------|-----:|----------|
| **I** | 99 | `lbu`, `lhu`, `lw`, `ret`, `sb`, `srli`, `srliw`, `sw` |

### `bds.c.o`

| Extension | Refs | Mnemonics |
|-----------|-----:|----------|
| **I** | 1125 | `add`, `addi`, `addiw`, `addw`, `andi`, `auipc`, `beq`, `beqz`, `bgeu`, `bltu`, `bne`, `bnez`, `jalr`, `jr`, `lbu`, `ld`, `li`, `lui`, `lw`, `lwu`, `mv`, `ret`, `sb`, `sd`, `sext.w`, `sh`, `slli`, `sllw`, `srli`, `srliw`, `srlw`, `sub`, `subw`, `sw`, `xor`, `zext.b` |
| **M** | 5 | `mul` |

### `bds_serialize.c.o`

| Extension | Refs | Mnemonics |
|-----------|-----:|----------|
| **I** | 459 | `add`, `addi`, `addiw`, `addw`, `auipc`, `beq`, `beqz`, `bltu`, `bne`, `jalr`, `lbu`, `ld`, `li`, `lui`, `lw`, `lwu`, `mv`, `ret`, `sb`, `sd`, `sext.w`, `slli`, `slliw`, `sllw`, `srli`, `srliw`, `subw`, `sw` |
| **M** | 14 | `mul`, `mulw` |

### `ltree.c.o`

| Extension | Refs | Mnemonics |
|-----------|-----:|----------|
| **I** | 124 | `add`, `addi`, `addiw`, `andi`, `auipc`, `bgeu`, `bltu`, `bne`, `bnez`, `jalr`, `jr`, `ld`, `li`, `lw`, `lwu`, `mv`, `sd`, `slli`, `slliw`, `srli`, `srliw`, `xor` |
| **M** | 5 | `mulw` |

### `params.c.o`

| Extension | Refs | Mnemonics |
|-----------|-----:|----------|
| **I** | 280 | `add`, `addi`, `addiw`, `addw`, `auipc`, `beq`, `bgeu`, `bltu`, `bne`, `bnez`, `jalr`, `jr`, `lbu`, `ld`, `li`, `lui`, `lw`, `lwu`, `mv`, `or`, `ret`, `sb`, `sd`, `sext.w`, `slli`, `slliw`, `srli`, `srliw`, `sw` |
| **M** | 6 | `divuw`, `mulw` |

### `sha2_local.c.o`

| Extension | Refs | Mnemonics |
|-----------|-----:|----------|
| **I** | 1953 | `add`, `addi`, `addiw`, `addw`, `and`, `andi`, `auipc`, `beqz`, `bgeu`, `bltu`, `bne`, `bnez`, `jalr`, `lbu`, `ld`, `li`, `lw`, `mv`, `not`, `or`, `ret`, `sb`, `sd`, `sext.w`, `slli`, `slliw`, `srli`, `srliw`, `sub`, `subw`, `sw`, `xor`, `zext.b` |

### `shake_local.c.o`

| Extension | Refs | Mnemonics |
|-----------|-----:|----------|
| **I** | 1337 | `add`, `addi`, `addiw`, `addw`, `and`, `auipc`, `beq`, `beqz`, `bgeu`, `bltu`, `bne`, `bnez`, `jalr`, `jr`, `lbu`, `ld`, `li`, `lw`, `lwu`, `mv`, `negw`, `not`, `or`, `ori`, `ret`, `sb`, `sd`, `sext.w`, `slli`, `srli`, `srliw`, `sub`, `subw`, `sw`, `xor` |

### `treehash.c.o`

| Extension | Refs | Mnemonics |
|-----------|-----:|----------|
| **I** | 482 | `add`, `addi`, `addiw`, `addw`, `andi`, `auipc`, `beq`, `beqz`, `bgeu`, `bne`, `bnez`, `jalr`, `ld`, `li`, `lui`, `lw`, `lwu`, `mv`, `ret`, `sd`, `slli`, `srli`, `srliw`, `srlw`, `sub`, `sw`, `xor` |
| **M** | 2 | `mulw` |

### `utils.c.o`

| Extension | Refs | Mnemonics |
|-----------|-----:|----------|
| **I** | 47 | `add`, `addi`, `addiw`, `beqz`, `bne`, `lbu`, `li`, `mv`, `or`, `ret`, `sb`, `slli`, `srli`, `xor` |

### `wots.c.o`

| Extension | Refs | Mnemonics |
|-----------|-----:|----------|
| **I** | 756 | `add`, `addi`, `addiw`, `andi`, `auipc`, `beq`, `beqz`, `bgeu`, `bltu`, `bne`, `bnez`, `jalr`, `lbu`, `ld`, `li`, `lui`, `lw`, `lwu`, `mv`, `negw`, `ret`, `sd`, `sext.w`, `slli`, `srli`, `srliw`, `srlw`, `subw`, `sw`, `xor` |
| **M** | 4 | `mulw` |

### `xmss.c.o`

| Extension | Refs | Mnemonics |
|-----------|-----:|----------|
| **I** | 634 | `add`, `addi`, `addiw`, `addw`, `andi`, `auipc`, `beqz`, `bltu`, `bnez`, `jalr`, `ld`, `li`, `lui`, `lw`, `lwu`, `mv`, `ret`, `sd`, `sext.w`, `slli`, `slliw`, `srli`, `srliw`, `sub`, `subw`, `xor` |
| **M** | 3 | `mulw` |

### `xmss_hash.c.o`

| Extension | Refs | Mnemonics |
|-----------|-----:|----------|
| **I** | 1082 | `add`, `addi`, `addiw`, `addw`, `auipc`, `beq`, `beqz`, `bgeu`, `bltu`, `bne`, `bnez`, `jalr`, `lbu`, `ld`, `li`, `lw`, `lwu`, `mv`, `ret`, `sb`, `sd`, `sext.w`, `slli`, `slliw`, `srli`, `sub`, `subw`, `sw`, `xor` |

### `xmss_mt.c.o`

| Extension | Refs | Mnemonics |
|-----------|-----:|----------|
| **I** | 1127 | `add`, `addi`, `addiw`, `addw`, `and`, `andi`, `auipc`, `beq`, `beqz`, `bgeu`, `bltu`, `bne`, `bnez`, `jalr`, `ld`, `li`, `lui`, `lw`, `lwu`, `mv`, `not`, `ret`, `sb`, `sd`, `sext.w`, `slli`, `slliw`, `srli`, `srliw`, `srlw`, `sub`, `subw`, `sw`, `xor` |
| **M** | 18 | `mul`, `mulw` |


## Implications for the Jasmin port

### Semantic extensions required

Based on the analysis of `libxmss.a`:

1. **I (base integer)**: Always required. Dominates the instruction mix
   (loads, stores, branches, arithmetic, shifts).

2. **M (multiply/divide)**: Used by the C compiler for address arithmetic
   and parameter derivation (`mulw`, `mul`, `divuw`). The Jasmin port
   must target at least **RV64IM**.

3. **A (atomics)**: Not expected in `libxmss.a` (XMSS is single-threaded).
   If present, investigate — may be a compiler intrinsic.

4. **F/D (float)**: Should be absent. XMSS is integer-only. If present,
   it's a compiler quirk from `-march=rv64gc` enabling the float ABI.

5. **Zba/Zbb/Zbs (bitmanip)**: Not emitted by the compiler with `-march=rv64gc`
   (Zb* is not part of rv64gc). The Jasmin port can **explicitly use**
   Zbb instructions (`ror`, `rev8`, `clz`) in the hash layer for SHA-2/SHAKE
   optimisation — these would be hand-written, not compiler-generated.

### C encoding

The assembler handles C encoding automatically. No explicit action needed
in Jasmin source code. The C encoding ratio in `libxmss.a` shows that a
significant fraction of instructions have compressed forms, confirming that
`rv64gc` produces compact code.

### Recommended Jasmin target ISA

- **Minimum**: `rv64im` — base integer + multiply/divide
- **Standard**: `rv64gc` (= `rv64imafd_zicsr_zifencei_c`) — for
  compatibility with standard Linux toolchains
- **Optimised hash layer**: `rv64gc_zbb` — adds `ror`/`rev8` for SHA-2
  and byte-reversal without breaking rv64gc compatibility for non-hash code

