# CLAUDE.md — isa/reports/

## What lives here

- `xmss_rv64_isa_profile.tex` — Hand-written LaTeX report (the deliverable).
  Covers methodology, rv64gc findings, the Zbb comparison (rv64gc vs
  rv64gc_zbb), recommended Jasmin targets, and next steps. Author: Wrenna
  Robson, with Claude co-authorship noted in a footnote.

- `xmss_rv64_isa_profile.pdf` — Compiled from the .tex. Rebuild with:
  ```bash
  cd isa/reports && pdflatex xmss_rv64_isa_profile.tex && pdflatex xmss_rv64_isa_profile.tex
  ```
  (Two passes for cross-references.)

- `.gitignore` — TeX auxiliary files (from github/gitignore TeX.gitignore).

## What is NOT committed (generated on demand)

- `xmss_rv64_isa_profile.md` — Auto-generated by `isa/scripts/analyse.sh`.
  Run the script to produce it; do not commit it (it would go stale).

## How the data was produced

1. `isa/scripts/gen_lookup.sh` generates an authoritative mnemonic→extension
   lookup table from the `third_party/riscv-opcodes` submodule.

2. `isa/scripts/analyse.sh` disassembles `impl/c/build-rv/libxmss.a`
   (compiled with `-march=rv64gc`), classifies every instruction using
   the lookup table, and writes the .md report.

3. The Zbb comparison in the .tex (Section 4.1–4.2, Tables 3–4) was
   produced by temporarily building `libxmss.a` with `-march=rv64gc_zbb`
   and running `analyse.sh` on that build. The data was then manually
   incorporated into the .tex. To reproduce:
   ```bash
   cd impl/c
   cmake -B build-rv-zbb \
     -DCMAKE_TOOLCHAIN_FILE=cmake/toolchain-riscv64.cmake \
     -DCMAKE_BUILD_TYPE=Release \
     -DCMAKE_C_FLAGS="-march=rv64gc_zbb -mabi=lp64d \
       -I/usr/riscv64-linux-gnu/include \
       -L/usr/riscv64-linux-gnu/lib"
   cmake --build build-rv-zbb --target xmss
   ../../isa/scripts/analyse.sh build-rv-zbb/libxmss.a
   rm -rf build-rv-zbb
   ```
   Then compare the generated .md against the rv64gc version.

## Key decisions

- The .tex is the source of truth for analysis and commentary. The .md
  is a raw data dump useful for spot-checking but not authoritative.
- The .tex includes hand-written interpretation (the Zbb comparison,
  "where Zbb lands" breakdown, Jasmin target recommendations) that goes
  beyond what the script produces.
- If the C implementation changes significantly (new modules, different
  compiler version), re-run the scripts and update the .tex manually.
